# Logstash file for converting CSV file (generated by workflow/09_export_database.py) to an Elasticsearch index

input {
    file {
        path => "../data_20210224/posts_20210224.csv"
        start_position => beginning
        sincedb_path => "/dev/null"
    }
}
filter {
    csv {
        columns => [
                "thread_id",
                "post_id",
                "post_url",
                "author_username",
                "author_user_id",
                "post_timestamp",
                "post_text"
        ]
        separator => ","
        }
    mutate {
        remove_field => [
                "message",
                "host",
                "path",
                "@timestamp",
                "@version"
        ]
        }
}
output {
    stdout
    {
        codec => rubydebug
    }
     elasticsearch {
        action => "index"
        hosts => ["127.0.0.1:9200"]
        index => "kiwifarms"
    }
}